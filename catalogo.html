<html>
  <head>
    <meta charset="utf-8">
    <script type="text/javascript" src="js/tabletop/src/tabletop.js"></script>
    <link rel="stylesheet" type="text/css" href="css/sss.css">
    <script type="text/javascript">
      window.onload = function() { init() };
      var html;
      var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1XQhBPx-YLj9Dtr9J1Hh_E3J0_J7x03CZkajdOhSeinY/pubhtml';

      function init() {
        Tabletop.init( { key: public_spreadsheet_url,
                         callback: showInfo,
                         simpleSheet: false } );
      }

      function showInfo(data) {
	//document.writeln("Fornecedores: <br>");
	html = "Fornecedores <br>";
	var i;
	for(var i=0; i< data.Fornecedores.elements.length; i++) {
	  //document.writeln("Nome: "+ data.Fornecedores.elements[i].Nome + "<br>");
          html += "Nome: "+ data.Fornecedores.elements[i].Nome + "<br>";
        }

	html += "Produtos: <br>";
	for(var i=0; i< data.Produtos.elements.length; i++) {
	  //document.writeln("<img src='"+ data.Produtos.elements[i].CaminhoImagem + "' width='100' alt='"+i+"'>");
          html += "<img src='"+ data.Produtos.elements[i].CaminhoImagem + "' width='250' height='200' alt='"+data.Produtos.elements[i].Codigo+"' title='"+data.Produtos.elements[i].Codigo+"'>";
        }
	
        // data comes through as a simple array since simpleSheet is turned on
        //document.getElementById("data").innerHTML = JSON.stringify(data);
        //console.log(data);
        document.write(html);
      }

      document.write("Carregando catalogo localizado em: <a target='_new' href='" + public_spreadsheet_url + "'>" + public_spreadsheet_url + "</a>");        
    </script>
  </head>
  <body>
  <h1> <center> CATALOGO DE PRODUTOS... Carregando </center> </h1>

  </body>
</html>
